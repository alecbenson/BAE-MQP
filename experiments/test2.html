<canvas id="canvas"></canvas>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="nodes.js"></script>
<style>
  body {
    margin: 0;
  }

  svg {
    position: absolute;
    top: 0;
    left: 0;
  }

  rect {
    fill: transparent;
  }
</style>
<script>
  var num = 200;

  var map = {};
  map.width = 960;
  map.height = 500;

  map.canvas =
    d3.select('body')
    .append('canvas')
    .attr('width', map.width)
    .attr('height', map.height)
    .node().getContext('2d');

  map.svg =
    d3.select('body')
    .append('svg')
    .attr('width', map.width)
    .attr('height', map.height)
    .append('g');

  map.svg.append('rect')
    .attr('class', 'overlay')
    .attr('width', map.width)
    .attr('height', map.height);

  map.canvas.nodes = dataset;
  map.svg.nodes = dataset;

  map.nodes = map.svg.nodes.concat(map.canvas.nodes)

  var x =
    d3.scale.linear()
    .domain([0, map.width])
    .range([0, map.width]);

  var y =
    d3.scale.linear()
    .domain([0, map.height])
    .range([map.height, 0]);

  d3.timer(step);

  function step() {
    map.canvas.fillStyle = "rgba(255,255,255,0.3)";
    map.canvas.fillRect(0, 0, map.width, map.height);
    map.canvas.fillStyle = "rgba(0,0,0,0.5)";
    $(dataset).each(function(index, p) {
      p.x += Math.round(2 * Math.random() - 1);
      p.y += Math.round(2 * Math.random() - 1);
      if (p.x < 0) p.y = map.width;
      if (p.x > map.width) p.y = 0;
      if (p.y < 0) p.y = map.height;
      if (p.y > map.height) p.y = 0;
      drawPoint(p);
      connectNodes(dataset[0], dataset[1]);
      connectNodes(dataset[0], dataset[2]);
      connectNodes(dataset[1], dataset[2])
    });
  };

  function drawPoint(p) {
    map.canvas.fillRect(p.x, p.y, 5, 5);
  };

  function connectNodes(p, other) {
    var edge = new Path2D();
    edge.moveTo(p.x, p.y)
    edge.lineTo(other.x, other.y)
    edge.closePath();
    map.canvas.stroke(edge);
  }
  //http://bl.ocks.org/sxv/4485778
</script>
<style>
  html,
  body {
    margin: 0;
    padding: 0;
  }
</style>
